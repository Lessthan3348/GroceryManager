<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Grocery List with Quantity & Unit Edit + Share</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
    max-width: 600px;
    background: #f7f9fc;
    color: #222;
  }
  h2 {
    margin-top: 30px;
    color: #333;
  }
  ul {
    list-style: none;
    padding: 0;
  }
  .item, .grocery-item {
    display: flex;
    justify-content: space-between;
    margin: 8px 0;
    padding: 8px 12px;
    border-radius: 6px;
    background: white;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    align-items: center;
    transition: background-color 0.3s ease;
  }
  .item:hover, .grocery-item:hover {
    background-color: #e6f0ff;
  }
  button {
    padding: 6px 14px;
    border: none;
    border-radius: 20px;
    background-color: #007bff;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  button:hover:not(:disabled) {
    background-color: #0056b3;
    transform: scale(1.1);
  }
  button:disabled {
    cursor: not-allowed;
    opacity: 0.5;
    background-color: #999;
  }
  #shareButtons {
    margin-top: 40px;
    display: flex;
    gap: 15px;
    justify-content: center;
  }
  .share-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    transition: transform 0.3s ease;
  }
  .share-btn:hover {
    transform: scale(1.2);
  }
  .whatsapp { background-color: #25D366; }
  .facebook { background-color: #1877F2; }
  .email { background-color: #D44638; }
  .twitter { background-color: #1DA1F2; }

  input[type="text"], input[type="number"] {
    width: 60px;
    padding: 4px 6px;
    margin-left: 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
    font-size: 14px;
    text-align: center;
  }
  .grocery-item > span {
    flex: 1;
    font-weight: 600;
  }
  .input-group {
    display: flex;
    align-items: center;
  }
</style>
<!-- FontAwesome CDN for icons -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>
</head>
<body>

<h2>Välj varor att lägga till</h2>
<ul id="items" class="item-list"></ul>

<h2>Din inköpslista</h2>
<ul id="groceryList" class="grocery-list"></ul>

<div id="shareButtons">
  <button class="share-btn whatsapp" title="Share on WhatsApp">
    <i class="fab fa-whatsapp"></i>
  </button>
  <button class="share-btn facebook" title="Share on Facebook">
    <i class="fab fa-facebook-f"></i>
  </button>
  <button class="share-btn email" title="Share via Email">
    <i class="fas fa-envelope"></i>
  </button>
  <button class="share-btn twitter" title="Share on Twitter">
    <i class="fab fa-twitter"></i>
  </button>
</div>

<script>
  // The allowed items, including quantity and unit separated by the first space and the rest is the name
  const allowedItemsRaw = [
    "1 påse napolitana salads mix",
    "1 kg tomat",
    "1 kg championer",
    "1 kg rödlök",
    "1 st margarin flytande rama",
    "1 dunk olivolja extra virgin 5 L",
    "1 kg gurka ofilmad",
    "1 kg citron",
    "1 hink handskalade räkor",
    "1/2 kg granny smith äpplen gröna",
    "1 flak Ramlösa naturell i burk",
    "1 flak coca cola i burk",
    "1 flak coca cola zero i burk",
    "1 liter standard mjölk",
    "1 spray grädde",
    "1 liter rama grädde",
    "1 påse riven mozzarella ost",
    "1 påse riven grano padano",
    "2 st 500 gram smör red label arla",
    "15 st bakad potatis",
    "5 kg spaghetti",
    "1 chèvre rulle",
    "1 påse mospotatis chefs cut",
    "1 ask ruccola",
    "1 kg lime",
    "1 ask basilika",
    "1 knippe färsk mynta",
    "1 kg apelsin",
    "1 ask salami Milano",
    "1 burk stenbitsrom",
    "1 hink kokta ägg skalade",
    "1 påse jordnötter saltade",
    "1 påse valnötskärnor",
    "1 påse vitlökskrutonger",
    "1 kartong grillad kycklingbröst fryst",
    "1 knippe dill",
    "1 kg tvättad kul potatis",
    "1 roman huvuden",
    "1 st godmorgon apelsinjuice",
    "1 st godmorgon äpple juice",
    "1 flak Sprite i burk",
    "1 kartong mozzarella bollar",
    "1 ask Prochutto crudo",
    "1 kartong fryst lingon",
    "1 crisp sallad"
  ];

  // Parse allowedItemsRaw into structured objects { quantity, unit, name }
  function parseItemString(itemStr) {
    // We'll assume the quantity is the first token, unit the second, rest is name,
    // but sometimes quantity might be like "1/2" or "2", unit might be one or two words
    // Because of variety, let's parse as: quantity is first token,
    // unit is the second token, unless the quantity token contains a space (like "2 st 500 gram")
    // For simplicity, we'll split by space, quantity is first, unit is second, rest is name

    // Special case for items like "2 st 500 gram smör red label arla" => quantity = 2, unit = "st 500 gram", name = "smör red label arla"
    // To handle that, we can consider quantity first token, then unit everything up to the last word(s) of name?

    // Instead, to keep it simple, for this example we'll parse quantity as first token,
    // unit as second token, rest as name. Complex cases will be treated as name.

    const parts = itemStr.split(' ');
    let quantity = parts[0];
    let unit = parts[1];
    let name = parts.slice(2).join(' ');

    // Fix for item with quantity "2" but unit "st 500 gram"
    if (quantity === "2" && parts[1] === "st" && parts[2] === "500") {
      quantity = "2";
      unit = "st 500 gram";
      name = parts.slice(4).join(' ');
    }
    // Fix for quantity "1/2"
    if (quantity.includes("/")) {
      unit = parts[1];
      name = parts.slice(2).join(' ');
    }

    return { quantity, unit, name };
  }

  const allowedItems = allowedItemsRaw.map(parseItemString);

  const itemsUl = document.getElementById('items');
  const groceryListUl = document.getElementById('groceryList');

  // Map to store added items with editable quantity and unit
  // Key is item full name (name + unit) to avoid duplicates
  const addedItems = new Map();

  function renderItems() {
    itemsUl.innerHTML = '';
    allowedItems.forEach(item => {
      const key = item.name + '|' + item.unit; // unique key

      const li = document.createElement('li');
      li.className = 'item';

      const span = document.createElement('span');
      span.textContent = `${item.quantity} ${item.unit} ${item.name}`;

      const addBtn = document.createElement('button');
      addBtn.textContent = 'Add';
      addBtn.disabled = addedItems.has(key);
      addBtn.addEventListener('click', () => addItem(key, {...item}));

      li.appendChild(span);
      li.appendChild(addBtn);
      itemsUl.appendChild(li);
    });
  }

  function renderGroceryList() {
    groceryListUl.innerHTML = '';
    addedItems.forEach((item, key) => {
      const li = document.createElement('li');
      li.className = 'grocery-item';

      const nameSpan = document.createElement('span');
      nameSpan.textContent = item.name;

      // Editable quantity input
      const qtyInput = document.createElement('input');
      qtyInput.type = 'text';
      qtyInput.value = item.quantity;
      qtyInput.title = "Quantity";
      qtyInput.addEventListener('input', e => {
        item.quantity = e.target.value;
      });

      // Editable unit input
      const unitInput = document.createElement('input');
      unitInput.type = 'text';
      unitInput.value = item.unit;
      unitInput.title = "Unit";
      unitInput.addEventListener('input', e => {
        item.unit = e.target.value;
      });

      const inputGroup = document.createElement('div');
      inputGroup.className = 'input-group';
      inputGroup.appendChild(qtyInput);
      inputGroup.appendChild(unitInput);

      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'Remove';
      removeBtn.addEventListener('click', () => removeItem(key));

      li.appendChild(nameSpan);
      li.appendChild(inputGroup);
      li.appendChild(removeBtn);
      groceryListUl.appendChild(li);
    });
  }

  function addItem(key, item) {
    addedItems.set(key, {...item});
    renderItems();
    renderGroceryList();
  }

  function removeItem(key) {
    addedItems.delete(key);
    renderItems();
    renderGroceryList();
  }

  // Share functions
  function getGroceryText() {
    if (addedItems.size === 0) return "Min inköpslista är tom.";
    let lines = ["Min inköpslista:"];
    addedItems.forEach(item => {
      lines.push(`${item.quantity} ${item.unit} ${item.name}`);
    });
    return lines.join("\n");
  }

  document.querySelector('.whatsapp').onclick = () => {
    const text = encodeURIComponent(getGroceryText());
    window.open(`https://api.whatsapp.com/send?text=${text}`, '_blank');
  };

  document.querySelector('.facebook').onclick = () => {
    const text = encodeURIComponent(getGroceryText());
    const url = encodeURIComponent('https://example.com');
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank');
  };

  document.querySelector('.email').onclick = () => {
    const subject = encodeURIComponent("Min inköpslista");
    const body = encodeURIComponent(getGroceryText());
    window.location.href = `mailto:?subject=${subject}&body=${body}`;
  };

  document.querySelector('.twitter').onclick = () => {
    const text = encodeURIComponent(getGroceryText());
    window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
  };

  renderItems();
  renderGroceryList();
</script>

</body>
</html>



