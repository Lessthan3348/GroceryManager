<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Grocery List with Quantity & Unit Edit + Share</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  /* Background and layout */
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    min-height: 100vh;
    background: 
      linear-gradient(rgba(0, 0, 0, 0.5), rgba(0,0,0,0.5)),
      url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
    background-size: cover;
    color: #f0f0f5;
    display: flex;
    justify-content: center;
    padding: 20px;
  }

  #container {
    background: rgba(20, 20, 30, 0.85);
    border-radius: 16px;
    padding: 30px 25px 40px;
    max-width: 700px;
    width: 100%;
    box-shadow: 0 0 30px rgba(0,0,0,0.7);
    display: flex;
    flex-direction: column;
  }

  h2 {
    color: #a9c9ff;
    margin-bottom: 20px;
    text-align: center;
    text-shadow: 0 0 5px #3d6efd;
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0 0 30px;
  }

  /* Items & grocery list styling */
  .item, .grocery-item {
    display: flex;
    justify-content: space-between;
    margin: 8px 0;
    padding: 12px 18px;
    border-radius: 10px;
    background: rgba(255,255,255,0.1);
    align-items: center;
    box-shadow: 0 2px 12px rgb(0 0 0 / 0.3);
    transition: background-color 0.4s ease, box-shadow 0.3s ease;
  }
  .item:hover, .grocery-item:hover {
    background-color: rgba(61, 110, 253, 0.3);
    box-shadow: 0 4px 25px rgb(61 110 253 / 0.8);
  }

  button {
    padding: 8px 18px;
    border: none;
    border-radius: 25px;
    background: linear-gradient(135deg, #3d6efd, #3354cc);
    color: white;
    font-weight: 700;
    cursor: pointer;
    font-size: 15px;
    box-shadow: 0 6px 15px rgba(61, 110, 253, 0.5);
    transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
    user-select: none;
  }
  button:disabled {
    cursor: not-allowed;
    opacity: 0.4;
    background: #4a4a4a;
    box-shadow: none;
  }
  button:not(:disabled):hover {
    background: linear-gradient(135deg, #2746c9, #1a2a7a);
    box-shadow: 0 8px 20px rgba(26, 42, 122, 0.9);
    transform: scale(1.12) rotate(-2deg);
  }
  button:not(:disabled):active {
    transform: scale(0.95) rotate(0deg);
    box-shadow: 0 3px 8px rgba(26, 42, 122, 0.7);
  }

  /* Share buttons */
  #shareButtons {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-top: auto;
  }
  .share-btn {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    transition: transform 0.4s ease, box-shadow 0.4s ease;
  }
  .share-btn:hover {
    transform: scale(1.3) rotate(10deg);
    box-shadow: 0 6px 18px rgba(0,0,0,0.7);
  }
  .whatsapp { background-color: #25D366; }
  .facebook { background-color: #1877F2; }
  .email { background-color: #D44638; }
  .twitter { background-color: #1DA1F2; }

  /* Inputs in grocery list */
  input[type="text"], input[type="number"] {
    width: 65px;
    padding: 6px 8px;
    margin-left: 10px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    background: rgba(255 255 255 / 0.15);
    color: #fff;
    box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
    transition: background-color 0.3s ease;
  }
  input[type="text"]:focus, input[type="number"]:focus {
    outline: none;
    background: rgba(255 255 255 / 0.3);
    box-shadow: 0 0 10px #3d6efd;
    color: #e0eaff;
  }

  /* Layout for input group */
  .input-group {
    display: flex;
    align-items: center;
  }

  .grocery-item > span {
    flex: 1;
    font-weight: 700;
    font-size: 16px;
    user-select: none;
  }

  /* Responsive styles */
  @media (max-width: 600px) {
    #container {
      padding: 20px 15px 30px;
    }
    .item, .grocery-item {
      flex-direction: column;
      align-items: flex-start;
      padding: 14px 16px;
    }
    button {
      width: 100%;
      margin-top: 10px;
      font-size: 16px;
    }
    .grocery-item > span {
      margin-bottom: 10px;
      font-size: 15px;
      text-align: left;
      width: 100%;
    }
    .input-group {
      width: 100%;
      justify-content: flex-start;
      gap: 15px;
      margin-bottom: 8px;
    }
  }
</style>
<!-- FontAwesome for icons -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>
</head>
<body>
  <div id="container">
    <h2>Välj varor att lägga till</h2>
    <ul id="items" class="item-list"></ul>

    <h2>Din inköpslista</h2>
    <ul id="groceryList" class="grocery-list"></ul>

    <div id="shareButtons" aria-label="Dela inköpslista">
      <button class="share-btn whatsapp" title="Dela på WhatsApp" aria-label="Dela på WhatsApp">
        <i class="fab fa-whatsapp"></i>
      </button>
      <button class="share-btn facebook" title="Dela på Facebook" aria-label="Dela på Facebook">
        <i class="fab fa-facebook-f"></i>
      </button>
      <button class="share-btn email" title="Dela via Email" aria-label="Dela via Email">
        <i class="fas fa-envelope"></i>
      </button>
      <button class="share-btn twitter" title="Dela på Twitter" aria-label="Dela på Twitter">
        <i class="fab fa-twitter"></i>
      </button>
    </div>
  </div>

<script>
  // Same allowed items as before
  const allowedItemsRaw = [
    "1 påse napolitana salads mix",
    "1 kg tomat",
    "1 kg championer",
    "1 kg rödlök",
    "1 st margarin flytande rama",
    "1 dunk olivolja extra virgin 5 L",
    "1 kg gurka ofilmad",
    "1 kg citron",
    "1 hink handskalade räkor",
    "1/2 kg granny smith äpplen gröna",
    "1 flak Ramlösa naturell i burk",
    "1 flak coca cola i burk",
    "1 flak coca cola zero i burk",
    "1 liter standard mjölk",
    "1 spray grädde",
    "1 liter rama grädde",
    "1 påse riven mozzarella ost",
    "1 påse riven grano padano",
    "2 st 500 gram smör red label arla",
    "15 st bakad potatis",
    "5 kg spaghetti",
    "1 chèvre rulle",
    "1 påse mospotatis chefs cut",
    "1 ask ruccola",
    "1 kg lime",
    "1 ask basilika",
    "1 knippe färsk mynta",
    "1 liter lemonad",
    "1 påse bladspenat",
    "1 paket fetaost",
    "1 påse vitlök",
  ];

  // Process allowed items to get item names (removing initial quantity)
  const allowedItems = allowedItemsRaw.map(item => {
    // Remove leading number + unit (e.g. "1 kg ", "1 st ", "1 påse ")
    return item.replace(/^\d+\s*(kg|st|liter|flak|påse|dunk|hink|flak|spray|ask|knippe|paket|st|/gi, '').trim()
      .replace(/^\d+\/\d+\s*/, '') // for fractions
      .replace(/^\d+/, '') // any leftover digits
      .trim();
  });

  // For simplicity, let's just remove the initial number and unit to get the item name
  // We'll store the full original item for display on add.

  // But since we want quantity & unit editable, let's allow any item from allowedItemsRaw as selectable

  const itemsUl = document.getElementById('items');
  const groceryListUl = document.getElementById('groceryList');

  // Populate selectable items
  allowedItemsRaw.forEach(fullItem => {
    const li = document.createElement('li');
    li.className = 'item';
    li.textContent = fullItem;
    const addBtn = document.createElement('button');
    addBtn.textContent = 'Lägg till';
    addBtn.setAttribute('aria-label', 'Lägg till ' + fullItem);
    li.appendChild(addBtn);

    addBtn.addEventListener('click', () => {
      addGroceryItem(fullItem);
    });

    itemsUl.appendChild(li);
  });

  // Grocery list data structure to hold current items
  const groceryItems = [];

  function addGroceryItem(fullItemText) {
    // Check if item already exists by name ignoring quantity/unit (basic approach)
    // We'll consider the item name after first space (remove quantity)
    // Extract name ignoring quantity/unit prefix (simple: remove first word(s))
    // Here just remove the initial count/unit - let's split by space and remove first 1 or 2 words depending on pattern

    // For simplicity, let's just add a unique id to each added item
    const id = Date.now() + Math.random().toString(36).substring(2, 7);

    // Extract quantity/unit and item name for editing:
    // We try to split the original item string by space, first token is quantity (or fraction), second token could be unit, rest is name.
    let quantity = '';
    let unit = '';
    let name = '';

    const parts = fullItemText.split(' ');
    if (parts.length > 1) {
      if (/^\d+\/\d+$/.test(parts[0])) {
        quantity = parts[0];
        unit = parts[1];
        name = parts.slice(2).join(' ');
      } else if (/^\d+/.test(parts[0])) {
        quantity = parts[0];
        unit = parts[1];
        name = parts.slice(2).join(' ');
      } else {
        quantity = '';
        unit = '';
        name = fullItemText;
      }
    } else {
      quantity = '';
      unit = '';
      name = fullItemText;
    }

    groceryItems.push({ id, quantity, unit, name });
    renderGroceryList();
  }

  function renderGroceryList() {
    groceryListUl.innerHTML = '';
    groceryItems.forEach(item => {
      const li = document.createElement('li');
      li.className = 'grocery-item';

      const nameSpan = document.createElement('span');
      nameSpan.textContent = item.name;
      nameSpan.title = 'Produktnamn';
      li.appendChild(nameSpan);

      // Quantity input
      const qtyInput = document.createElement('input');
      qtyInput.type = 'text';
      qtyInput.value = item.quantity;
      qtyInput.title = 'Mängd';
      qtyInput.setAttribute('aria-label', `Mängd för ${item.name}`);
      qtyInput.addEventListener('input', e => {
        item.quantity = e.target.value;
      });

      // Unit input
      const unitInput = document.createElement('input');
      unitInput.type = 'text';
      unitInput.value = item.unit;
      unitInput.title = 'Enhet';
      unitInput.setAttribute('aria-label', `Enhet för ${item.name}`);
      unitInput.addEventListener('input', e => {
        item.unit = e.target.value;
      });

      // Group qty & unit inputs
      const inputGroup = document.createElement('div');
      inputGroup.className = 'input-group';
      inputGroup.appendChild(qtyInput);
      inputGroup.appendChild(unitInput);
      li.appendChild(inputGroup);

      // Remove button
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'Ta bort';
      removeBtn.title = 'Ta bort från listan';
      removeBtn.setAttribute('aria-label', 'Ta bort ' + item.name + ' från listan');
      removeBtn.addEventListener('click', () => {
        const index = groceryItems.findIndex(i => i.id === item.id);
        if (index !== -1) {
          groceryItems.splice(index, 1);
          renderGroceryList();
        }
      });

      li.appendChild(removeBtn);
      groceryListUl.appendChild(li);
    });
  }

  // Share buttons logic

  function getGroceryText() {
    if (groceryItems.length === 0) return "Inköpslistan är tom.";
    return groceryItems.map(item => {
      const qtyPart = item.quantity ? item.quantity + ' ' : '';
      const unitPart = item.unit ? item.unit + ' ' : '';
      return `${qtyPart}${unitPart}${item.name}`;
    }).join('\n');
  }

  const shareButtons = document.querySelectorAll('#shareButtons button');

  shareButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const text = encodeURIComponent(getGroceryText());
      let url = '';

      if (btn.classList.contains('whatsapp')) {
        url = `https://wa.me/?text=${text}`;
      } else if (btn.classList.contains('facebook')) {
        // Facebook sharing with text is tricky, usually uses URL; fallback to sharing text on own page
        alert('Facebook sharing supports URLs only. Copy your list manually!');
        return;
      } else if (btn.classList.contains('email')) {
        url = `mailto:?subject=Min inköpslista&body=${text}`;
      } else if (btn.classList.contains('twitter')) {
        url = `https://twitter.com/intent/tweet?text=${text}`;
      }

      if (url) {
        window.open(url, '_blank');
      }
    });
  });
</script>
</body>
</html>




